(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,a,t){e.exports=t(28)},20:function(e,a,t){},21:function(e,a,t){},22:function(e,a,t){},27:function(e,a,t){},28:function(e,a,t){"use strict";t.r(a);var n=t(1),s=t.n(n),l=t(9),c=t.n(l),r=(t(20),t(29));t(21);var o=e=>{let{channels:a,setChannel:t}=e;return s.a.createElement("div",{className:"channel-list"},s.a.createElement("h2",{className:"channel-list-title"},"Available Channels"),a.length>0?s.a.createElement("ul",{className:"channel-list-items"},a.map(e=>s.a.createElement("li",{key:e.id,className:"channel-item",onClick:()=>{console.log("Channel selected:",e),t(e)}},s.a.createElement("span",{className:"channel-name"},e.name)))):s.a.createElement("p",{className:"no-channels-text"},"No channels available."))};var m=e=>{let{onSendMessage:a,channelName:t}=e;const[l,c]=Object(n.useState)("");return s.a.createElement("div",{className:"message-input"},s.a.createElement("input",{type:"text",placeholder:"Type a message",value:l,onChange:e=>c(e.target.value)}),s.a.createElement("button",{onClick:()=>{l.trim()&&(a(l,t),c(""))}},"Send"))},i=t(10);t(22);var d=e=>{let{channel:a,userName:t}=e;const[l,c]=Object(n.useState)([]),[o,d]=Object(n.useState)(!1),[u,g]=Object(n.useState)(null),[h,p]=Object(n.useState)({}),E=a.endpoint.replace(/\/$/,"");console.log("API URL:",E),Object(n.useEffect)(()=>{(async()=>{d(!0),g(null),a.name;try{const e=await r.a.get(a.endpoint,{headers:{Authorization:"authkey "+a.authkey}});c(e.data)}catch(u){console.error("Error fetching messages:",u),g("Failed to load messages")}finally{d(!1)}})()},[a]),Object(n.useEffect)(()=>{const e=localStorage.getItem("messages");e&&c(JSON.parse(e))},[]);const b=e=>e.replace(/\*([^*]+)\*/g,"<i>$1</i>").replace(/\[nop\](.*?)\[\/nop\]/g,"<b>$1</b>").replace(/\_\_([^_]+)\_\_/g,"<u>$1</u>");a.authKey;return Object(n.useEffect)(()=>{l.length>0&&localStorage.setItem("messages",JSON.stringify(l)),console.log("Messages saved to localStorage:",l)},[l]),s.a.createElement("div",{className:"chat-window"},s.a.createElement("div",{className:"chat-header"},s.a.createElement("h3",null,a.name)),s.a.createElement("div",{className:"chat-messages"},o&&s.a.createElement("div",{className:"loading"},"Loading..."),u&&s.a.createElement("div",{className:"error"},u),l.map((e,n)=>s.a.createElement("div",{key:n,className:`message-container ${e.sender===t?"user-message":""}`},e.sender&&s.a.createElement("div",{className:`message-sender ${"plantbot"===e.sender?"bot-sender":""}`},e.sender),s.a.createElement("div",{className:`message ${e.sender===t?"user":"other"}`},s.a.createElement("div",{className:"message-content",dangerouslySetInnerHTML:{__html:b(e.content)}})),s.a.createElement("button",{className:`pin-button ${e.pinned?"pinned":""}`,onClick:()=>(async e=>{c(t=>{const n=[...t],s=n[e];if(s.pinned)return console.log("Message already pinned, skipping toggle."),t;s.pinned=!s.pinned;const l=`${E}/messages?channel=${a.name}`;return fetch(`${l}/update_message/${s.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({pinned:s.pinned})}).then(e=>e.json()).then(a=>{console.log("Backend updated message:",a),c(t=>{const n=[...t];return n[e]=a,n})}).catch(e=>{console.error("Error updating message on the backend:",e)}),n})})(n),"aria-label":"Pin message"}," ",s.a.createElement(i.a,null)," "),e.response&&s.a.createElement("div",{className:"response"},s.a.createElement("span",{className:"bot-label"},"Plantbot: "),s.a.createElement("span",{className:"response-content",dangerouslySetInnerHTML:{__html:b(e.response)}}))))),s.a.createElement(m,{onSendMessage:async(e,n)=>{const s={name:n,sender:t,content:e,timestamp:(new Date).toISOString(),pinned:!1};console.log("Sending message payload:",s);try{const n=await r.a.post(`${E}/messages`,s,{headers:{Authorization:"authkey "+a.authkey}});console.log("Message sent successfully:",n.data),c(a=>[...a,{sender:t,content:e,timestamp:(new Date).toISOString(),response:n.data.response,pinned:!1}])}catch(u){console.error("Error sending message:",u),g("Failed to send message")}},channelName:a.name}))};var u=e=>{let{setUserName:a}=e;const[t,l]=Object(n.useState)("");Object(n.useEffect)(()=>{const e=localStorage.getItem("userName");e&&a(e)},[a]);return s.a.createElement("div",{className:"username-prompt"},s.a.createElement("input",{type:"text",placeholder:"Enter your name",value:t,onChange:e=>l(e.target.value)}),s.a.createElement("button",{onClick:()=>{t.trim()&&(localStorage.setItem("userName",t),a(t))}},"Submit"))};t(27);var g=()=>{const[e,a]=Object(n.useState)(""),[t,l]=Object(n.useState)([]),[c,m]=Object(n.useState)(null);return Object(n.useEffect)(()=>{r.a.get("http://vm146.rz.uni-osnabrueck.de/hub/channels",{headers:{Authorization:"Bearer Crr-K24d-2N"}}).then(e=>{console.log("Fetched channels:",e.data.channels),l(e.data.channels)}).catch(e=>{console.error("Error fetching channels:",e)})},[]),e?s.a.createElement("div",{className:"app"},s.a.createElement("h1",null,"Welcome, ",e),s.a.createElement("div",{className:"channel-chat-container"},s.a.createElement(o,{channels:t,setChannel:m}),c&&s.a.createElement(d,{channel:c,userName:e}))):s.a.createElement(u,{setUserName:a})};var h=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,30)).then(a=>{let{getCLS:t,getFID:n,getFCP:s,getLCP:l,getTTFB:c}=a;t(e),n(e),s(e),l(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(g,null))),h()}},[[12,1,2]]]);
//# sourceMappingURL=main.27c569df.chunk.js.map