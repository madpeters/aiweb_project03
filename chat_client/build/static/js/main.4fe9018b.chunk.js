(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,a,t){e.exports=t(28)},20:function(e,a,t){},21:function(e,a,t){},22:function(e,a,t){},27:function(e,a,t){},28:function(e,a,t){"use strict";t.r(a);var n=t(1),s=t.n(n),l=t(9),c=t.n(l),r=(t(20),t(29));t(21);var o=e=>{let{channels:a,setChannel:t}=e;return s.a.createElement("div",{className:"channel-list"},s.a.createElement("h2",{className:"channel-list-title"},"Available Channels"),a.length>0?s.a.createElement("ul",{className:"channel-list-items"},a.map(e=>s.a.createElement("li",{key:e.id,className:"channel-item",onClick:()=>{console.log("Channel selected:",e),t(e)}},s.a.createElement("span",{className:"channel-name"},e.name)))):s.a.createElement("p",{className:"no-channels-text"},"No channels available."))};var m=e=>{let{onSendMessage:a,channelName:t}=e;const[l,c]=Object(n.useState)("");return s.a.createElement("div",{className:"message-input"},s.a.createElement("input",{type:"text",placeholder:"Type a message",value:l,onChange:e=>c(e.target.value)}),s.a.createElement("button",{onClick:()=>{l.trim()&&(a(l,t),c(""))}},"Send"))},i=t(10);t(22);var u=e=>{let{channel:a,userName:t}=e;const[l,c]=Object(n.useState)([]),[o,u]=Object(n.useState)(!1),[h,d]=Object(n.useState)(null),p=a.endpoint.replace(/\/$/,"");Object(n.useEffect)(()=>{const e=async()=>{u(!0),d(null);try{const e=await r.a.get(p+"/messages",{headers:{Authorization:"authkey "+a.authkey},params:{channel:a.name}});c(e.data)}catch(h){console.error("Error fetching messages:",h),d("Failed to load messages")}finally{u(!1)}};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[a,p]);const g=e=>e.replace(/\*([^*]+)\*/g,"<i>$1</i>").replace(/\[nop\](.*?)\[\/nop\]/g,"<b>$1</b>").replace(/\_\_([^_]+)\_\_/g,"<u>$1</u>");return s.a.createElement("div",{className:"chat-window"},s.a.createElement("div",{className:"chat-header"},s.a.createElement("h3",null,a.name)),s.a.createElement("div",{className:"chat-messages"},o&&s.a.createElement("div",{className:"loading"},"Loading..."),h&&s.a.createElement("div",{className:"error"},h),l.map(e=>s.a.createElement("div",{key:e.id,className:`message-container ${e.sender===t?"user-message":""}`},e.sender&&s.a.createElement("div",{className:`message-sender ${"plantbot"===e.sender?"bot-sender":""}`},e.sender),s.a.createElement("div",{className:`message ${e.sender===t?"user":"other"}`},s.a.createElement("div",{className:"message-content",dangerouslySetInnerHTML:{__html:g(e.content)}})),s.a.createElement("button",{className:`pin-button ${e.pinned?"pinned":""}`,onClick:()=>(async(e,t)=>{try{await r.a.patch(p+`/update_message/${e}`,{pinned:!t},{headers:{"Content-Type":"application/json"}});const n=await r.a.get(p+"/messages",{headers:{Authorization:"authkey "+a.authkey},params:{channel:a.name}});c(n.data)}catch(h){console.error("Error updating message:",h),d("Failed to update message")}})(e.id,e.pinned),"aria-label":"Pin message"}," ",s.a.createElement(i.a,null)," "),e.response&&s.a.createElement("div",{className:"response"},s.a.createElement("span",{className:"bot-label"},"Plantbot: "),s.a.createElement("span",{className:"response-content",dangerouslySetInnerHTML:{__html:g(e.response)}}))))),s.a.createElement(m,{onSendMessage:async(e,n)=>{const s={name:n,sender:t,content:e,timestamp:(new Date).toISOString(),pinned:!1};try{await r.a.post(p+"/messages",s,{headers:{Authorization:"authkey "+a.authkey}});const e=await r.a.get(p+"/messages",{headers:{Authorization:"authkey "+a.authkey},params:{channel:a.name}});c(e.data)}catch(h){console.error("Error sending message:",h),d("Failed to send message")}},channelName:a.name}))};var h=e=>{let{setUserName:a}=e;const[t,l]=Object(n.useState)("");Object(n.useEffect)(()=>{const e=localStorage.getItem("userName");e&&a(e)},[a]);return s.a.createElement("div",{className:"username-prompt"},s.a.createElement("input",{type:"text",placeholder:"Enter your name",value:t,onChange:e=>l(e.target.value)}),s.a.createElement("button",{onClick:()=>{t.trim()&&(localStorage.setItem("userName",t),a(t))}},"Submit"))};t(27);var d=()=>{const[e,a]=Object(n.useState)(""),[t,l]=Object(n.useState)([]),[c,m]=Object(n.useState)(null);return Object(n.useEffect)(()=>{r.a.get("http://localhost:5555/channels",{headers:{Authorization:"Bearer 1234567890"}}).then(e=>{console.log("Fetched channels:",e.data.channels),l(e.data.channels)}).catch(e=>{console.error("Error fetching channels:",e)})},[]),e?s.a.createElement("div",{className:"app"},s.a.createElement("h1",null,"Welcome, ",e),s.a.createElement("div",{className:"channel-chat-container"},s.a.createElement(o,{channels:t,setChannel:m}),c&&s.a.createElement(u,{channel:c,userName:e}))):s.a.createElement(h,{setUserName:a})};var p=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,30)).then(a=>{let{getCLS:t,getFID:n,getFCP:s,getLCP:l,getTTFB:c}=a;t(e),n(e),s(e),l(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(d,null))),p()}},[[12,1,2]]]);
//# sourceMappingURL=main.4fe9018b.chunk.js.map